{% extends "base.html" %}

{% block title %}Voice Entry - Warehouse Management{% endblock %}

{% block content %}
<div class="voice-container">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="voice-header">
                <h1>Voice Box Entry</h1>
                <p class="next-box-hint">Next suggested box number: <strong>{{ next_box_number }}</strong></p>
            </div>

            <div id="browserWarning" class="browser-warning" style="display: none;">
                Your browser may not fully support voice recognition. For best results, use Chrome or Edge.
            </div>

            <div id="errorMessage" class="error-message" style="display: none;"></div>
            <div id="successMessage" class="success-message" style="display: none;"></div>

            <div class="mic-container">
                <button id="micButton" class="mic-button" onclick="toggleListening()">
                    <span id="micIcon">üé§</span>
                </button>
                <div id="micStatus" class="mic-status">Click to start speaking</div>
            </div>

            <div class="transcript-box">
                <div class="transcript-label">What I heard</div>
                <div id="transcriptText" class="transcript-text">Waiting for speech...</div>
            </div>

            <div id="previewCard" class="preview-card" style="display: none;">
                <div class="preview-header">
                    <div class="preview-title">Box Preview</div>
                    <div id="previewBadge" class="preview-badge">Ready to save</div>
                </div>

                <div class="preview-row">
                    <span class="preview-label">Box Number</span>
                    <span id="previewBoxNumber" class="preview-value">‚Äî</span>
                </div>
                <div class="preview-row">
                    <span class="preview-label">Weight</span>
                    <span id="previewWeight" class="preview-value">‚Äî</span>
                </div>

                <div class="contents-list">
                    <div class="preview-label" style="margin-bottom: 0.75rem;">Contents</div>
                    <div id="contentsList">
                        <div class="empty-state">
                            <div class="empty-state-icon">üì¶</div>
                            <div>No items added yet</div>
                        </div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button id="btnAddMore" class="btn-voice btn-add-more" onclick="addMore()">
                        üé§ Add More
                    </button>
                    <button id="btnConfirm" class="btn-voice btn-confirm" onclick="confirmBox()" disabled>
                        ‚úì Confirm & Save
                    </button>
                    <button id="btnRedo" class="btn-voice btn-redo" onclick="redoEntry()">
                        ‚Ü∫ Start Over
                    </button>
                </div>
            </div>

            <div class="help-section">
                <div class="help-title">Example voice commands</div>
                <div class="help-examples">
                    <div class="help-example">"Box 1221, 45 pounds, 12 laptops"</div>
                    <div class="help-example">"15 twenty inch square LCDs"</div>
                    <div class="help-example">"23 twenty-four inch LCDs and 5 keyboards"</div>
                    <div class="help-example">"Box number twelve twenty one, 30 pounds"</div>
                </div>
            </div>

            <div class="action-buttons" style="margin-top: 2rem;">
                <a href="{{ url_for('boxes') }}" class="btn-voice btn-cancel">‚Üê Back to Boxes</a>
                <a href="{{ url_for('new_box') }}" class="btn-voice btn-redo">Manual Entry</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/voice-entry.js') }}"></script>
<script>
    // Initialize with the next suggested box number
    window.suggestedBoxNumber = "{{ next_box_number }}";
</script>
{% endblock %}

