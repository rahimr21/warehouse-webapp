{% extends "base.html" %}

{% block title %}Containers - Warehouse Management{% endblock %}

{% block extra_css %}
<style>
    .search-box {
        max-width: 300px;
    }
    .container-totals {
        font-size: 0.9rem;
        color: #666;
    }
</style>
{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Containers</h1>
    <a href="{{ url_for('new_container') }}" class="btn btn-primary">New Container</a>
</div>

<div class="mb-3">
    <input type="text" id="searchBox" class="form-control search-box" placeholder="Search containers...">
</div>

<div class="table-responsive">
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th>Name</th>
                <th>Date</th>
                <th>Contents</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for container in containers %}
            <tr class="container-row">
                <td>{{ container.name }}</td>
                <td>{{ container.date.strftime('%Y-%m-%d') }}</td>
                <td>
                    {% set totals = container.calculate_totals() %}
                    {% for product_type, quantity in totals.items() %}
                        <div class="container-totals">{{ product_type }}: {{ quantity }}</div>
                    {% endfor %}
                </td>
                <td>
                    <a href="{{ url_for('container_details', container_id=container.id) }}" class="btn btn-sm btn-outline-primary">Details</a>
                    <a href="{{ url_for('edit_container', container_id=container.id) }}" class="btn btn-sm btn-outline-secondary">Edit</a>
                    <a href="{{ url_for('export_container', container_id=container.id) }}" class="btn btn-sm btn-outline-success">Export</a>
                    <form method="POST" action="{{ url_for('delete_container', container_id=container.id) }}" style="display: inline;" 
                          onsubmit="return confirm('Are you sure you want to delete this container? This will remove all boxes from the container but not delete the boxes themselves.')">
                        <button type="submit" class="btn btn-sm btn-outline-danger">Delete</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.getElementById('searchBox').addEventListener('keyup', function() {
    const searchText = this.value.toLowerCase();
    const rows = document.getElementsByClassName('container-row');
    
    for (let row of rows) {
        const text = row.textContent.toLowerCase();
        row.style.display = text.includes(searchText) ? '' : 'none';
    }
});
</script>
{% endblock %} 